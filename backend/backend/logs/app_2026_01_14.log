2026-01-14 11:29:32,216 | INFO | File received: 01 06.xlsx
2026-01-14 11:29:32,217 | INFO | File saved at: backend/uploads/01 06.xlsx
2026-01-14 11:29:32,217 | INFO | Started processing file: backend/uploads/01 06.xlsx
2026-01-14 11:29:32,221 | ERROR | ❌ Error occurred while processing excel
Traceback (most recent call last):
  File "/Users/aditya/doctor-email-automation/.venv/lib/python3.14/site-packages/pandas/compat/_optional.py", line 135, in import_optional_dependency
    module = importlib.import_module(name)
  File "/Library/Frameworks/Python.framework/Versions/3.14/lib/python3.14/importlib/__init__.py", line 88, in import_module
    return _bootstrap._gcd_import(name[level:], package, level)
           ~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<frozen importlib._bootstrap>", line 1398, in _gcd_import
  File "<frozen importlib._bootstrap>", line 1371, in _find_and_load
  File "<frozen importlib._bootstrap>", line 1335, in _find_and_load_unlocked
ModuleNotFoundError: No module named 'openpyxl'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/aditya/doctor-email-automation/backend/app/processor.py", line 18, in process_excel
    df = pd.read_excel(input_excel, skiprows=9)
  File "/Users/aditya/doctor-email-automation/.venv/lib/python3.14/site-packages/pandas/io/excel/_base.py", line 495, in read_excel
    io = ExcelFile(
        io,
    ...<2 lines>...
        engine_kwargs=engine_kwargs,
    )
  File "/Users/aditya/doctor-email-automation/.venv/lib/python3.14/site-packages/pandas/io/excel/_base.py", line 1567, in __init__
    self._reader = self._engines[engine](
                   ~~~~~~~~~~~~~~~~~~~~~^
        self._io,
        ^^^^^^^^^
        storage_options=storage_options,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        engine_kwargs=engine_kwargs,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Users/aditya/doctor-email-automation/.venv/lib/python3.14/site-packages/pandas/io/excel/_openpyxl.py", line 552, in __init__
    import_optional_dependency("openpyxl")
    ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^
  File "/Users/aditya/doctor-email-automation/.venv/lib/python3.14/site-packages/pandas/compat/_optional.py", line 138, in import_optional_dependency
    raise ImportError(msg)
ImportError: Missing optional dependency 'openpyxl'.  Use pip or conda to install openpyxl.
2026-01-14 11:29:32,226 | ERROR | ❌ Upload processing failed
Traceback (most recent call last):
  File "/Users/aditya/doctor-email-automation/.venv/lib/python3.14/site-packages/pandas/compat/_optional.py", line 135, in import_optional_dependency
    module = importlib.import_module(name)
  File "/Library/Frameworks/Python.framework/Versions/3.14/lib/python3.14/importlib/__init__.py", line 88, in import_module
    return _bootstrap._gcd_import(name[level:], package, level)
           ~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<frozen importlib._bootstrap>", line 1398, in _gcd_import
  File "<frozen importlib._bootstrap>", line 1371, in _find_and_load
  File "<frozen importlib._bootstrap>", line 1335, in _find_and_load_unlocked
ModuleNotFoundError: No module named 'openpyxl'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/aditya/doctor-email-automation/backend/app/main.py", line 35, in upload_excel
    zip_path = process_excel(file_path, OUTPUT_DIR)
  File "/Users/aditya/doctor-email-automation/backend/app/processor.py", line 79, in process_excel
    raise e
  File "/Users/aditya/doctor-email-automation/backend/app/processor.py", line 18, in process_excel
    df = pd.read_excel(input_excel, skiprows=9)
  File "/Users/aditya/doctor-email-automation/.venv/lib/python3.14/site-packages/pandas/io/excel/_base.py", line 495, in read_excel
    io = ExcelFile(
        io,
    ...<2 lines>...
        engine_kwargs=engine_kwargs,
    )
  File "/Users/aditya/doctor-email-automation/.venv/lib/python3.14/site-packages/pandas/io/excel/_base.py", line 1567, in __init__
    self._reader = self._engines[engine](
                   ~~~~~~~~~~~~~~~~~~~~~^
        self._io,
        ^^^^^^^^^
        storage_options=storage_options,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        engine_kwargs=engine_kwargs,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Users/aditya/doctor-email-automation/.venv/lib/python3.14/site-packages/pandas/io/excel/_openpyxl.py", line 552, in __init__
    import_optional_dependency("openpyxl")
    ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^
  File "/Users/aditya/doctor-email-automation/.venv/lib/python3.14/site-packages/pandas/compat/_optional.py", line 138, in import_optional_dependency
    raise ImportError(msg)
ImportError: Missing optional dependency 'openpyxl'.  Use pip or conda to install openpyxl.
2026-01-14 11:34:42,920 | INFO | File received: 01 02.xlsx
2026-01-14 11:34:42,921 | INFO | File saved at: backend/uploads/01 02.xlsx
2026-01-14 11:34:42,921 | INFO | Started processing file: backend/uploads/01 02.xlsx
2026-01-14 11:34:43,011 | INFO | Excel loaded successfully. Rows: 69
2026-01-14 11:34:43,011 | ERROR | ❌ Error occurred while processing excel
Traceback (most recent call last):
  File "/Users/aditya/doctor-email-automation/backend/app/processor.py", line 22, in process_excel
    df = df[
         ~~^
        ["Patient First Name", "Patient E-mail", "Appointment Provider Name"]
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ].copy()
    ^
  File "/Users/aditya/doctor-email-automation/.venv/lib/python3.14/site-packages/pandas/core/frame.py", line 4119, in __getitem__
    indexer = self.columns._get_indexer_strict(key, "columns")[1]
              ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^
  File "/Users/aditya/doctor-email-automation/.venv/lib/python3.14/site-packages/pandas/core/indexes/base.py", line 6212, in _get_indexer_strict
    self._raise_if_missing(keyarr, indexer, axis_name)
    ~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/aditya/doctor-email-automation/.venv/lib/python3.14/site-packages/pandas/core/indexes/base.py", line 6261, in _raise_if_missing
    raise KeyError(f"None of [{key}] are in the [{axis_name}]")
KeyError: "None of [Index(['Patient First Name', 'Patient E-mail', 'Appointment Provider Name'], dtype='object')] are in the [columns]"
2026-01-14 11:34:43,015 | ERROR | ❌ Upload processing failed
Traceback (most recent call last):
  File "/Users/aditya/doctor-email-automation/backend/app/main.py", line 35, in upload_excel
    zip_path = process_excel(file_path, OUTPUT_DIR)
  File "/Users/aditya/doctor-email-automation/backend/app/processor.py", line 79, in process_excel
    raise e
  File "/Users/aditya/doctor-email-automation/backend/app/processor.py", line 22, in process_excel
    df = df[
         ~~^
        ["Patient First Name", "Patient E-mail", "Appointment Provider Name"]
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ].copy()
    ^
  File "/Users/aditya/doctor-email-automation/.venv/lib/python3.14/site-packages/pandas/core/frame.py", line 4119, in __getitem__
    indexer = self.columns._get_indexer_strict(key, "columns")[1]
              ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^
  File "/Users/aditya/doctor-email-automation/.venv/lib/python3.14/site-packages/pandas/core/indexes/base.py", line 6212, in _get_indexer_strict
    self._raise_if_missing(keyarr, indexer, axis_name)
    ~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/aditya/doctor-email-automation/.venv/lib/python3.14/site-packages/pandas/core/indexes/base.py", line 6261, in _raise_if_missing
    raise KeyError(f"None of [{key}] are in the [{axis_name}]")
KeyError: "None of [Index(['Patient First Name', 'Patient E-mail', 'Appointment Provider Name'], dtype='object')] are in the [columns]"
2026-01-14 11:37:41,328 | INFO | File received: 01 06.xlsx
2026-01-14 11:37:41,329 | INFO | File saved at: backend/uploads/01 06.xlsx
2026-01-14 11:37:41,329 | INFO | Started processing file: backend/uploads/01 06.xlsx
2026-01-14 11:37:41,420 | INFO | Excel loaded successfully. Rows: 53
2026-01-14 11:37:41,421 | ERROR | ❌ Error occurred while processing excel
Traceback (most recent call last):
  File "/Users/aditya/doctor-email-automation/backend/app/processor.py", line 22, in process_excel
    df = df[
         ~~^
        ["Patient First Name", "Patient E-mail", "Appointment Provider Name"]
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ].copy()
    ^
  File "/Users/aditya/doctor-email-automation/.venv/lib/python3.14/site-packages/pandas/core/frame.py", line 4119, in __getitem__
    indexer = self.columns._get_indexer_strict(key, "columns")[1]
              ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^
  File "/Users/aditya/doctor-email-automation/.venv/lib/python3.14/site-packages/pandas/core/indexes/base.py", line 6212, in _get_indexer_strict
    self._raise_if_missing(keyarr, indexer, axis_name)
    ~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/aditya/doctor-email-automation/.venv/lib/python3.14/site-packages/pandas/core/indexes/base.py", line 6261, in _raise_if_missing
    raise KeyError(f"None of [{key}] are in the [{axis_name}]")
KeyError: "None of [Index(['Patient First Name', 'Patient E-mail', 'Appointment Provider Name'], dtype='object')] are in the [columns]"
2026-01-14 11:37:41,425 | ERROR | ❌ Upload processing failed
Traceback (most recent call last):
  File "/Users/aditya/doctor-email-automation/backend/app/main.py", line 35, in upload_excel
    zip_path = process_excel(file_path, OUTPUT_DIR)
  File "/Users/aditya/doctor-email-automation/backend/app/processor.py", line 85, in process_excel
    raise e
  File "/Users/aditya/doctor-email-automation/backend/app/processor.py", line 22, in process_excel
    df = df[
         ~~^
        ["Patient First Name", "Patient E-mail", "Appointment Provider Name"]
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ].copy()
    ^
  File "/Users/aditya/doctor-email-automation/.venv/lib/python3.14/site-packages/pandas/core/frame.py", line 4119, in __getitem__
    indexer = self.columns._get_indexer_strict(key, "columns")[1]
              ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^
  File "/Users/aditya/doctor-email-automation/.venv/lib/python3.14/site-packages/pandas/core/indexes/base.py", line 6212, in _get_indexer_strict
    self._raise_if_missing(keyarr, indexer, axis_name)
    ~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/aditya/doctor-email-automation/.venv/lib/python3.14/site-packages/pandas/core/indexes/base.py", line 6261, in _raise_if_missing
    raise KeyError(f"None of [{key}] are in the [{axis_name}]")
KeyError: "None of [Index(['Patient First Name', 'Patient E-mail', 'Appointment Provider Name'], dtype='object')] are in the [columns]"
2026-01-14 11:38:39,464 | INFO | File received: 01 02.xlsx
2026-01-14 11:38:39,466 | INFO | File saved at: backend/uploads/01 02.xlsx
2026-01-14 11:38:39,466 | INFO | Started processing file: backend/uploads/01 02.xlsx
2026-01-14 11:38:39,489 | INFO | Excel loaded successfully. Rows: 69
2026-01-14 11:38:39,489 | ERROR | ❌ Error occurred while processing excel
Traceback (most recent call last):
  File "/Users/aditya/doctor-email-automation/backend/app/processor.py", line 22, in process_excel
    df = df[
         ~~^
        ["Patient First Name", "Patient E-mail", "Appointment Provider Name"]
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ].copy()
    ^
  File "/Users/aditya/doctor-email-automation/.venv/lib/python3.14/site-packages/pandas/core/frame.py", line 4119, in __getitem__
    indexer = self.columns._get_indexer_strict(key, "columns")[1]
              ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^
  File "/Users/aditya/doctor-email-automation/.venv/lib/python3.14/site-packages/pandas/core/indexes/base.py", line 6212, in _get_indexer_strict
    self._raise_if_missing(keyarr, indexer, axis_name)
    ~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/aditya/doctor-email-automation/.venv/lib/python3.14/site-packages/pandas/core/indexes/base.py", line 6261, in _raise_if_missing
    raise KeyError(f"None of [{key}] are in the [{axis_name}]")
KeyError: "None of [Index(['Patient First Name', 'Patient E-mail', 'Appointment Provider Name'], dtype='object')] are in the [columns]"
2026-01-14 11:38:39,490 | ERROR | ❌ Upload processing failed
Traceback (most recent call last):
  File "/Users/aditya/doctor-email-automation/backend/app/main.py", line 35, in upload_excel
    zip_path = process_excel(file_path, OUTPUT_DIR)
  File "/Users/aditya/doctor-email-automation/backend/app/processor.py", line 85, in process_excel
    raise e
  File "/Users/aditya/doctor-email-automation/backend/app/processor.py", line 22, in process_excel
    df = df[
         ~~^
        ["Patient First Name", "Patient E-mail", "Appointment Provider Name"]
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ].copy()
    ^
  File "/Users/aditya/doctor-email-automation/.venv/lib/python3.14/site-packages/pandas/core/frame.py", line 4119, in __getitem__
    indexer = self.columns._get_indexer_strict(key, "columns")[1]
              ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^
  File "/Users/aditya/doctor-email-automation/.venv/lib/python3.14/site-packages/pandas/core/indexes/base.py", line 6212, in _get_indexer_strict
    self._raise_if_missing(keyarr, indexer, axis_name)
    ~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/aditya/doctor-email-automation/.venv/lib/python3.14/site-packages/pandas/core/indexes/base.py", line 6261, in _raise_if_missing
    raise KeyError(f"None of [{key}] are in the [{axis_name}]")
KeyError: "None of [Index(['Patient First Name', 'Patient E-mail', 'Appointment Provider Name'], dtype='object')] are in the [columns]"
2026-01-14 11:41:58,357 | INFO | File received: 01 06.xlsx
2026-01-14 11:41:58,358 | INFO | File saved at: backend/uploads/01 06.xlsx
2026-01-14 11:41:58,358 | INFO | Started processing file: backend/uploads/01 06.xlsx
2026-01-14 11:41:58,470 | INFO | Excel loaded successfully. Rows: 54
2026-01-14 11:41:58,471 | INFO | Dropped 10 invalid rows
2026-01-14 11:41:58,474 | INFO | Created file for doctor 'Bice, Jamie' with 20 records
2026-01-14 11:41:58,474 | INFO | Created file for doctor 'Nguyen, Jeffrey' with 24 records
2026-01-14 11:41:58,474 | INFO | Created combined all_doctors.csv
2026-01-14 11:41:58,475 | INFO | ZIP file created successfully
2026-01-14 11:41:58,475 | INFO | Processing completed successfully
2026-01-14 11:41:58,475 | INFO | Sending ZIP file to client
2026-01-14 11:54:43,345 | INFO | File received: 01 07.xlsx
2026-01-14 11:54:43,346 | INFO | File saved at: backend/uploads/01 07.xlsx
2026-01-14 11:54:43,346 | INFO | Started processing file: backend/uploads/01 07.xlsx
2026-01-14 11:54:43,363 | INFO | Excel loaded successfully. Rows: 48
2026-01-14 11:54:43,364 | INFO | Dropped 7 invalid rows
2026-01-14 11:54:43,367 | INFO | Created file for doctor 'Bice, Jamie' with 23 records
2026-01-14 11:54:43,368 | INFO | Created file for doctor 'KAR, JITESH K' with 1 records
2026-01-14 11:54:43,368 | INFO | Created file for doctor 'Nguyen, Jeffrey' with 17 records
2026-01-14 11:54:43,369 | INFO | Created combined all_doctors.csv
2026-01-14 11:54:43,369 | INFO | ZIP file created successfully
2026-01-14 11:54:43,369 | INFO | Processing completed successfully
2026-01-14 11:54:43,369 | INFO | Sending ZIP file to client
