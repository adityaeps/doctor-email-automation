2026-01-15 22:21:23,308 | INFO | File received: 01 07.xlsx
2026-01-15 22:21:23,310 | INFO | Started processing file: /Users/aditya/doctor-email-automation/backend/uploads/01 07.xlsx
2026-01-15 22:21:23,316 | ERROR | ❌ Error occurred while processing excel
Traceback (most recent call last):
  File "/Users/aditya/doctor-email-automation/backend/venv/lib/python3.14/site-packages/pandas/compat/_optional.py", line 135, in import_optional_dependency
    module = importlib.import_module(name)
  File "/Library/Frameworks/Python.framework/Versions/3.14/lib/python3.14/importlib/__init__.py", line 88, in import_module
    return _bootstrap._gcd_import(name[level:], package, level)
           ~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<frozen importlib._bootstrap>", line 1398, in _gcd_import
  File "<frozen importlib._bootstrap>", line 1371, in _find_and_load
  File "<frozen importlib._bootstrap>", line 1335, in _find_and_load_unlocked
ModuleNotFoundError: No module named 'openpyxl'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/aditya/doctor-email-automation/backend/app/processor.py", line 18, in process_excel
    df = pd.read_excel(input_excel, skiprows=8)
  File "/Users/aditya/doctor-email-automation/backend/venv/lib/python3.14/site-packages/pandas/io/excel/_base.py", line 495, in read_excel
    io = ExcelFile(
        io,
    ...<2 lines>...
        engine_kwargs=engine_kwargs,
    )
  File "/Users/aditya/doctor-email-automation/backend/venv/lib/python3.14/site-packages/pandas/io/excel/_base.py", line 1567, in __init__
    self._reader = self._engines[engine](
                   ~~~~~~~~~~~~~~~~~~~~~^
        self._io,
        ^^^^^^^^^
        storage_options=storage_options,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        engine_kwargs=engine_kwargs,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Users/aditya/doctor-email-automation/backend/venv/lib/python3.14/site-packages/pandas/io/excel/_openpyxl.py", line 552, in __init__
    import_optional_dependency("openpyxl")
    ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^
  File "/Users/aditya/doctor-email-automation/backend/venv/lib/python3.14/site-packages/pandas/compat/_optional.py", line 138, in import_optional_dependency
    raise ImportError(msg)
ImportError: Missing optional dependency 'openpyxl'.  Use pip or conda to install openpyxl.
2026-01-15 22:21:23,322 | ERROR | Upload failed
Traceback (most recent call last):
  File "/Users/aditya/doctor-email-automation/backend/venv/lib/python3.14/site-packages/pandas/compat/_optional.py", line 135, in import_optional_dependency
    module = importlib.import_module(name)
  File "/Library/Frameworks/Python.framework/Versions/3.14/lib/python3.14/importlib/__init__.py", line 88, in import_module
    return _bootstrap._gcd_import(name[level:], package, level)
           ~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<frozen importlib._bootstrap>", line 1398, in _gcd_import
  File "<frozen importlib._bootstrap>", line 1371, in _find_and_load
  File "<frozen importlib._bootstrap>", line 1335, in _find_and_load_unlocked
ModuleNotFoundError: No module named 'openpyxl'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/aditya/doctor-email-automation/backend/app/main.py", line 50, in upload_excel
    zip_path = process_excel(str(file_path), str(OUTPUT_DIR))
  File "/Users/aditya/doctor-email-automation/backend/app/processor.py", line 85, in process_excel
    raise e
  File "/Users/aditya/doctor-email-automation/backend/app/processor.py", line 18, in process_excel
    df = pd.read_excel(input_excel, skiprows=8)
  File "/Users/aditya/doctor-email-automation/backend/venv/lib/python3.14/site-packages/pandas/io/excel/_base.py", line 495, in read_excel
    io = ExcelFile(
        io,
    ...<2 lines>...
        engine_kwargs=engine_kwargs,
    )
  File "/Users/aditya/doctor-email-automation/backend/venv/lib/python3.14/site-packages/pandas/io/excel/_base.py", line 1567, in __init__
    self._reader = self._engines[engine](
                   ~~~~~~~~~~~~~~~~~~~~~^
        self._io,
        ^^^^^^^^^
        storage_options=storage_options,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        engine_kwargs=engine_kwargs,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Users/aditya/doctor-email-automation/backend/venv/lib/python3.14/site-packages/pandas/io/excel/_openpyxl.py", line 552, in __init__
    import_optional_dependency("openpyxl")
    ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^
  File "/Users/aditya/doctor-email-automation/backend/venv/lib/python3.14/site-packages/pandas/compat/_optional.py", line 138, in import_optional_dependency
    raise ImportError(msg)
ImportError: Missing optional dependency 'openpyxl'.  Use pip or conda to install openpyxl.
2026-01-15 22:23:52,320 | INFO | File received: 01 02.xlsx
2026-01-15 22:23:52,320 | INFO | Started processing file: /Users/aditya/doctor-email-automation/backend/uploads/01 02.xlsx
2026-01-15 22:23:52,322 | ERROR | ❌ Error occurred while processing excel
Traceback (most recent call last):
  File "/Users/aditya/doctor-email-automation/backend/venv/lib/python3.14/site-packages/pandas/compat/_optional.py", line 135, in import_optional_dependency
    module = importlib.import_module(name)
  File "/Library/Frameworks/Python.framework/Versions/3.14/lib/python3.14/importlib/__init__.py", line 88, in import_module
    return _bootstrap._gcd_import(name[level:], package, level)
           ~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<frozen importlib._bootstrap>", line 1398, in _gcd_import
  File "<frozen importlib._bootstrap>", line 1371, in _find_and_load
  File "<frozen importlib._bootstrap>", line 1335, in _find_and_load_unlocked
ModuleNotFoundError: No module named 'openpyxl'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/aditya/doctor-email-automation/backend/app/processor.py", line 18, in process_excel
    df = pd.read_excel(input_excel, skiprows=8)
  File "/Users/aditya/doctor-email-automation/backend/venv/lib/python3.14/site-packages/pandas/io/excel/_base.py", line 495, in read_excel
    io = ExcelFile(
        io,
    ...<2 lines>...
        engine_kwargs=engine_kwargs,
    )
  File "/Users/aditya/doctor-email-automation/backend/venv/lib/python3.14/site-packages/pandas/io/excel/_base.py", line 1567, in __init__
    self._reader = self._engines[engine](
                   ~~~~~~~~~~~~~~~~~~~~~^
        self._io,
        ^^^^^^^^^
        storage_options=storage_options,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        engine_kwargs=engine_kwargs,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Users/aditya/doctor-email-automation/backend/venv/lib/python3.14/site-packages/pandas/io/excel/_openpyxl.py", line 552, in __init__
    import_optional_dependency("openpyxl")
    ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^
  File "/Users/aditya/doctor-email-automation/backend/venv/lib/python3.14/site-packages/pandas/compat/_optional.py", line 138, in import_optional_dependency
    raise ImportError(msg)
ImportError: Missing optional dependency 'openpyxl'.  Use pip or conda to install openpyxl.
2026-01-15 22:23:52,325 | ERROR | Upload failed
Traceback (most recent call last):
  File "/Users/aditya/doctor-email-automation/backend/venv/lib/python3.14/site-packages/pandas/compat/_optional.py", line 135, in import_optional_dependency
    module = importlib.import_module(name)
  File "/Library/Frameworks/Python.framework/Versions/3.14/lib/python3.14/importlib/__init__.py", line 88, in import_module
    return _bootstrap._gcd_import(name[level:], package, level)
           ~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<frozen importlib._bootstrap>", line 1398, in _gcd_import
  File "<frozen importlib._bootstrap>", line 1371, in _find_and_load
  File "<frozen importlib._bootstrap>", line 1335, in _find_and_load_unlocked
ModuleNotFoundError: No module named 'openpyxl'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/aditya/doctor-email-automation/backend/app/main.py", line 50, in upload_excel
    zip_path = process_excel(str(file_path), str(OUTPUT_DIR))
  File "/Users/aditya/doctor-email-automation/backend/app/processor.py", line 85, in process_excel
    raise e
  File "/Users/aditya/doctor-email-automation/backend/app/processor.py", line 18, in process_excel
    df = pd.read_excel(input_excel, skiprows=8)
  File "/Users/aditya/doctor-email-automation/backend/venv/lib/python3.14/site-packages/pandas/io/excel/_base.py", line 495, in read_excel
    io = ExcelFile(
        io,
    ...<2 lines>...
        engine_kwargs=engine_kwargs,
    )
  File "/Users/aditya/doctor-email-automation/backend/venv/lib/python3.14/site-packages/pandas/io/excel/_base.py", line 1567, in __init__
    self._reader = self._engines[engine](
                   ~~~~~~~~~~~~~~~~~~~~~^
        self._io,
        ^^^^^^^^^
        storage_options=storage_options,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        engine_kwargs=engine_kwargs,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Users/aditya/doctor-email-automation/backend/venv/lib/python3.14/site-packages/pandas/io/excel/_openpyxl.py", line 552, in __init__
    import_optional_dependency("openpyxl")
    ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^
  File "/Users/aditya/doctor-email-automation/backend/venv/lib/python3.14/site-packages/pandas/compat/_optional.py", line 138, in import_optional_dependency
    raise ImportError(msg)
ImportError: Missing optional dependency 'openpyxl'.  Use pip or conda to install openpyxl.
2026-01-15 22:24:04,985 | INFO | File received: 01 02.xlsx
2026-01-15 22:24:04,986 | INFO | Started processing file: /Users/aditya/doctor-email-automation/backend/uploads/01 02.xlsx
2026-01-15 22:24:04,987 | ERROR | ❌ Error occurred while processing excel
Traceback (most recent call last):
  File "/Users/aditya/doctor-email-automation/backend/venv/lib/python3.14/site-packages/pandas/compat/_optional.py", line 135, in import_optional_dependency
    module = importlib.import_module(name)
  File "/Library/Frameworks/Python.framework/Versions/3.14/lib/python3.14/importlib/__init__.py", line 88, in import_module
    return _bootstrap._gcd_import(name[level:], package, level)
           ~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<frozen importlib._bootstrap>", line 1398, in _gcd_import
  File "<frozen importlib._bootstrap>", line 1371, in _find_and_load
  File "<frozen importlib._bootstrap>", line 1335, in _find_and_load_unlocked
ModuleNotFoundError: No module named 'openpyxl'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/aditya/doctor-email-automation/backend/app/processor.py", line 18, in process_excel
    df = pd.read_excel(input_excel, skiprows=8)
  File "/Users/aditya/doctor-email-automation/backend/venv/lib/python3.14/site-packages/pandas/io/excel/_base.py", line 495, in read_excel
    io = ExcelFile(
        io,
    ...<2 lines>...
        engine_kwargs=engine_kwargs,
    )
  File "/Users/aditya/doctor-email-automation/backend/venv/lib/python3.14/site-packages/pandas/io/excel/_base.py", line 1567, in __init__
    self._reader = self._engines[engine](
                   ~~~~~~~~~~~~~~~~~~~~~^
        self._io,
        ^^^^^^^^^
        storage_options=storage_options,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        engine_kwargs=engine_kwargs,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Users/aditya/doctor-email-automation/backend/venv/lib/python3.14/site-packages/pandas/io/excel/_openpyxl.py", line 552, in __init__
    import_optional_dependency("openpyxl")
    ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^
  File "/Users/aditya/doctor-email-automation/backend/venv/lib/python3.14/site-packages/pandas/compat/_optional.py", line 138, in import_optional_dependency
    raise ImportError(msg)
ImportError: Missing optional dependency 'openpyxl'.  Use pip or conda to install openpyxl.
2026-01-15 22:24:04,988 | ERROR | Upload failed
Traceback (most recent call last):
  File "/Users/aditya/doctor-email-automation/backend/venv/lib/python3.14/site-packages/pandas/compat/_optional.py", line 135, in import_optional_dependency
    module = importlib.import_module(name)
  File "/Library/Frameworks/Python.framework/Versions/3.14/lib/python3.14/importlib/__init__.py", line 88, in import_module
    return _bootstrap._gcd_import(name[level:], package, level)
           ~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<frozen importlib._bootstrap>", line 1398, in _gcd_import
  File "<frozen importlib._bootstrap>", line 1371, in _find_and_load
  File "<frozen importlib._bootstrap>", line 1335, in _find_and_load_unlocked
ModuleNotFoundError: No module named 'openpyxl'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/aditya/doctor-email-automation/backend/app/main.py", line 50, in upload_excel
    zip_path = process_excel(str(file_path), str(OUTPUT_DIR))
  File "/Users/aditya/doctor-email-automation/backend/app/processor.py", line 85, in process_excel
    raise e
  File "/Users/aditya/doctor-email-automation/backend/app/processor.py", line 18, in process_excel
    df = pd.read_excel(input_excel, skiprows=8)
  File "/Users/aditya/doctor-email-automation/backend/venv/lib/python3.14/site-packages/pandas/io/excel/_base.py", line 495, in read_excel
    io = ExcelFile(
        io,
    ...<2 lines>...
        engine_kwargs=engine_kwargs,
    )
  File "/Users/aditya/doctor-email-automation/backend/venv/lib/python3.14/site-packages/pandas/io/excel/_base.py", line 1567, in __init__
    self._reader = self._engines[engine](
                   ~~~~~~~~~~~~~~~~~~~~~^
        self._io,
        ^^^^^^^^^
        storage_options=storage_options,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        engine_kwargs=engine_kwargs,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Users/aditya/doctor-email-automation/backend/venv/lib/python3.14/site-packages/pandas/io/excel/_openpyxl.py", line 552, in __init__
    import_optional_dependency("openpyxl")
    ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^
  File "/Users/aditya/doctor-email-automation/backend/venv/lib/python3.14/site-packages/pandas/compat/_optional.py", line 138, in import_optional_dependency
    raise ImportError(msg)
ImportError: Missing optional dependency 'openpyxl'.  Use pip or conda to install openpyxl.
2026-01-15 22:25:57,086 | INFO | File received: 01 06.xlsx
2026-01-15 22:25:57,087 | INFO | Started processing file: /Users/aditya/doctor-email-automation/backend/uploads/01 06.xlsx
2026-01-15 22:25:57,088 | ERROR | ❌ Error occurred while processing excel
Traceback (most recent call last):
  File "/Users/aditya/doctor-email-automation/backend/venv/lib/python3.14/site-packages/pandas/compat/_optional.py", line 135, in import_optional_dependency
    module = importlib.import_module(name)
  File "/Library/Frameworks/Python.framework/Versions/3.14/lib/python3.14/importlib/__init__.py", line 88, in import_module
    return _bootstrap._gcd_import(name[level:], package, level)
           ~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<frozen importlib._bootstrap>", line 1398, in _gcd_import
  File "<frozen importlib._bootstrap>", line 1371, in _find_and_load
  File "<frozen importlib._bootstrap>", line 1335, in _find_and_load_unlocked
ModuleNotFoundError: No module named 'openpyxl'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/aditya/doctor-email-automation/backend/app/processor.py", line 18, in process_excel
    df = pd.read_excel(input_excel, skiprows=8)
  File "/Users/aditya/doctor-email-automation/backend/venv/lib/python3.14/site-packages/pandas/io/excel/_base.py", line 495, in read_excel
    io = ExcelFile(
        io,
    ...<2 lines>...
        engine_kwargs=engine_kwargs,
    )
  File "/Users/aditya/doctor-email-automation/backend/venv/lib/python3.14/site-packages/pandas/io/excel/_base.py", line 1567, in __init__
    self._reader = self._engines[engine](
                   ~~~~~~~~~~~~~~~~~~~~~^
        self._io,
        ^^^^^^^^^
        storage_options=storage_options,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        engine_kwargs=engine_kwargs,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Users/aditya/doctor-email-automation/backend/venv/lib/python3.14/site-packages/pandas/io/excel/_openpyxl.py", line 552, in __init__
    import_optional_dependency("openpyxl")
    ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^
  File "/Users/aditya/doctor-email-automation/backend/venv/lib/python3.14/site-packages/pandas/compat/_optional.py", line 138, in import_optional_dependency
    raise ImportError(msg)
ImportError: Missing optional dependency 'openpyxl'.  Use pip or conda to install openpyxl.
2026-01-15 22:25:57,091 | ERROR | Upload failed
Traceback (most recent call last):
  File "/Users/aditya/doctor-email-automation/backend/venv/lib/python3.14/site-packages/pandas/compat/_optional.py", line 135, in import_optional_dependency
    module = importlib.import_module(name)
  File "/Library/Frameworks/Python.framework/Versions/3.14/lib/python3.14/importlib/__init__.py", line 88, in import_module
    return _bootstrap._gcd_import(name[level:], package, level)
           ~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<frozen importlib._bootstrap>", line 1398, in _gcd_import
  File "<frozen importlib._bootstrap>", line 1371, in _find_and_load
  File "<frozen importlib._bootstrap>", line 1335, in _find_and_load_unlocked
ModuleNotFoundError: No module named 'openpyxl'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/aditya/doctor-email-automation/backend/app/main.py", line 50, in upload_excel
    zip_path = process_excel(str(file_path), str(OUTPUT_DIR))
  File "/Users/aditya/doctor-email-automation/backend/app/processor.py", line 85, in process_excel
    raise e
  File "/Users/aditya/doctor-email-automation/backend/app/processor.py", line 18, in process_excel
    df = pd.read_excel(input_excel, skiprows=8)
  File "/Users/aditya/doctor-email-automation/backend/venv/lib/python3.14/site-packages/pandas/io/excel/_base.py", line 495, in read_excel
    io = ExcelFile(
        io,
    ...<2 lines>...
        engine_kwargs=engine_kwargs,
    )
  File "/Users/aditya/doctor-email-automation/backend/venv/lib/python3.14/site-packages/pandas/io/excel/_base.py", line 1567, in __init__
    self._reader = self._engines[engine](
                   ~~~~~~~~~~~~~~~~~~~~~^
        self._io,
        ^^^^^^^^^
        storage_options=storage_options,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        engine_kwargs=engine_kwargs,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Users/aditya/doctor-email-automation/backend/venv/lib/python3.14/site-packages/pandas/io/excel/_openpyxl.py", line 552, in __init__
    import_optional_dependency("openpyxl")
    ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^
  File "/Users/aditya/doctor-email-automation/backend/venv/lib/python3.14/site-packages/pandas/compat/_optional.py", line 138, in import_optional_dependency
    raise ImportError(msg)
ImportError: Missing optional dependency 'openpyxl'.  Use pip or conda to install openpyxl.
2026-01-15 22:29:01,684 | INFO | File received: 01 02.xlsx
2026-01-15 22:29:01,686 | INFO | Started processing file: /Users/aditya/doctor-email-automation/backend/uploads/01 02.xlsx
2026-01-15 22:29:01,687 | ERROR | ❌ Error occurred while processing excel
Traceback (most recent call last):
  File "/Users/aditya/doctor-email-automation/backend/venv/lib/python3.14/site-packages/pandas/compat/_optional.py", line 135, in import_optional_dependency
    module = importlib.import_module(name)
  File "/Library/Frameworks/Python.framework/Versions/3.14/lib/python3.14/importlib/__init__.py", line 88, in import_module
    return _bootstrap._gcd_import(name[level:], package, level)
           ~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<frozen importlib._bootstrap>", line 1398, in _gcd_import
  File "<frozen importlib._bootstrap>", line 1371, in _find_and_load
  File "<frozen importlib._bootstrap>", line 1335, in _find_and_load_unlocked
ModuleNotFoundError: No module named 'openpyxl'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/aditya/doctor-email-automation/backend/app/processor.py", line 18, in process_excel
    df = pd.read_excel(input_excel, skiprows=8)
  File "/Users/aditya/doctor-email-automation/backend/venv/lib/python3.14/site-packages/pandas/io/excel/_base.py", line 495, in read_excel
    io = ExcelFile(
        io,
    ...<2 lines>...
        engine_kwargs=engine_kwargs,
    )
  File "/Users/aditya/doctor-email-automation/backend/venv/lib/python3.14/site-packages/pandas/io/excel/_base.py", line 1567, in __init__
    self._reader = self._engines[engine](
                   ~~~~~~~~~~~~~~~~~~~~~^
        self._io,
        ^^^^^^^^^
        storage_options=storage_options,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        engine_kwargs=engine_kwargs,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Users/aditya/doctor-email-automation/backend/venv/lib/python3.14/site-packages/pandas/io/excel/_openpyxl.py", line 552, in __init__
    import_optional_dependency("openpyxl")
    ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^
  File "/Users/aditya/doctor-email-automation/backend/venv/lib/python3.14/site-packages/pandas/compat/_optional.py", line 138, in import_optional_dependency
    raise ImportError(msg)
ImportError: Missing optional dependency 'openpyxl'.  Use pip or conda to install openpyxl.
2026-01-15 22:29:01,691 | ERROR | Upload failed
Traceback (most recent call last):
  File "/Users/aditya/doctor-email-automation/backend/venv/lib/python3.14/site-packages/pandas/compat/_optional.py", line 135, in import_optional_dependency
    module = importlib.import_module(name)
  File "/Library/Frameworks/Python.framework/Versions/3.14/lib/python3.14/importlib/__init__.py", line 88, in import_module
    return _bootstrap._gcd_import(name[level:], package, level)
           ~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<frozen importlib._bootstrap>", line 1398, in _gcd_import
  File "<frozen importlib._bootstrap>", line 1371, in _find_and_load
  File "<frozen importlib._bootstrap>", line 1335, in _find_and_load_unlocked
ModuleNotFoundError: No module named 'openpyxl'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/aditya/doctor-email-automation/backend/app/main.py", line 50, in upload_excel
    zip_path = process_excel(str(file_path), str(OUTPUT_DIR))
  File "/Users/aditya/doctor-email-automation/backend/app/processor.py", line 85, in process_excel
    raise e
  File "/Users/aditya/doctor-email-automation/backend/app/processor.py", line 18, in process_excel
    df = pd.read_excel(input_excel, skiprows=8)
  File "/Users/aditya/doctor-email-automation/backend/venv/lib/python3.14/site-packages/pandas/io/excel/_base.py", line 495, in read_excel
    io = ExcelFile(
        io,
    ...<2 lines>...
        engine_kwargs=engine_kwargs,
    )
  File "/Users/aditya/doctor-email-automation/backend/venv/lib/python3.14/site-packages/pandas/io/excel/_base.py", line 1567, in __init__
    self._reader = self._engines[engine](
                   ~~~~~~~~~~~~~~~~~~~~~^
        self._io,
        ^^^^^^^^^
        storage_options=storage_options,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        engine_kwargs=engine_kwargs,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Users/aditya/doctor-email-automation/backend/venv/lib/python3.14/site-packages/pandas/io/excel/_openpyxl.py", line 552, in __init__
    import_optional_dependency("openpyxl")
    ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^
  File "/Users/aditya/doctor-email-automation/backend/venv/lib/python3.14/site-packages/pandas/compat/_optional.py", line 138, in import_optional_dependency
    raise ImportError(msg)
ImportError: Missing optional dependency 'openpyxl'.  Use pip or conda to install openpyxl.
2026-01-15 22:34:18,635 | INFO | File received: 01 02.xlsx
2026-01-15 22:34:18,636 | INFO | Started processing file: /Users/aditya/doctor-email-automation/backend/uploads/01 02.xlsx
2026-01-15 22:34:18,721 | INFO | Excel loaded successfully. Rows: 70
2026-01-15 22:34:18,725 | INFO | Dropped 15 invalid rows
2026-01-15 22:34:18,731 | INFO | Created file for doctor 'Bice, Jamie' with 18 records
2026-01-15 22:34:18,732 | INFO | Created file for doctor 'KAR, JITESH K' with 16 records
2026-01-15 22:34:18,732 | INFO | Created file for doctor 'Nguyen, Jeffrey' with 21 records
2026-01-15 22:34:18,733 | INFO | Created combined all_doctors.csv
2026-01-15 22:34:18,733 | INFO | ZIP file created successfully
2026-01-15 22:34:18,734 | INFO | Processing completed successfully
2026-01-19 10:17:40,877 | INFO | File received: 01 05.xlsx
2026-01-19 10:17:40,890 | INFO | Started processing file: /Users/aditya/doctor-email-automation/backend/uploads/01 05.xlsx
2026-01-19 10:17:41,079 | INFO | Excel loaded successfully. Rows: 100
2026-01-19 10:17:41,096 | INFO | Dropped 13 invalid rows
2026-01-19 10:17:41,110 | INFO | Created file for doctor 'Bice, Jamie' with 20 records
2026-01-19 10:17:41,110 | INFO | Created file for doctor 'KAR, JITESH K' with 43 records
2026-01-19 10:17:41,111 | INFO | Created file for doctor 'Nguyen, Jeffrey' with 24 records
2026-01-19 10:17:41,111 | INFO | Created combined all_doctors.csv
2026-01-19 10:17:41,113 | INFO | ZIP file created successfully
2026-01-19 10:17:41,113 | INFO | Processing completed successfully
2026-01-19 10:20:10,283 | INFO | File received: 01 08.xlsx
2026-01-19 10:20:10,285 | INFO | Started processing file: /Users/aditya/doctor-email-automation/backend/uploads/01 08.xlsx
2026-01-19 10:20:10,316 | INFO | Excel loaded successfully. Rows: 98
2026-01-19 10:20:10,321 | ERROR | ❌ Error occurred while processing excel
Traceback (most recent call last):
  File "/Users/aditya/doctor-email-automation/backend/app/processor.py", line 22, in process_excel
    df = df[
         ~~^
        ["Patient First Name", "Patient E-mail", "Appointment Provider Name"]
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ].copy()
    ^
  File "/Users/aditya/doctor-email-automation/backend/venv/lib/python3.14/site-packages/pandas/core/frame.py", line 4119, in __getitem__
    indexer = self.columns._get_indexer_strict(key, "columns")[1]
              ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^
  File "/Users/aditya/doctor-email-automation/backend/venv/lib/python3.14/site-packages/pandas/core/indexes/base.py", line 6212, in _get_indexer_strict
    self._raise_if_missing(keyarr, indexer, axis_name)
    ~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/aditya/doctor-email-automation/backend/venv/lib/python3.14/site-packages/pandas/core/indexes/base.py", line 6264, in _raise_if_missing
    raise KeyError(f"{not_found} not in index")
KeyError: "['Appointment Provider Name'] not in index"
2026-01-19 10:20:10,337 | ERROR | Upload failed
Traceback (most recent call last):
  File "/Users/aditya/doctor-email-automation/backend/app/main.py", line 50, in upload_excel
    zip_path = process_excel(str(file_path), str(OUTPUT_DIR))
  File "/Users/aditya/doctor-email-automation/backend/app/processor.py", line 85, in process_excel
    raise e
  File "/Users/aditya/doctor-email-automation/backend/app/processor.py", line 22, in process_excel
    df = df[
         ~~^
        ["Patient First Name", "Patient E-mail", "Appointment Provider Name"]
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ].copy()
    ^
  File "/Users/aditya/doctor-email-automation/backend/venv/lib/python3.14/site-packages/pandas/core/frame.py", line 4119, in __getitem__
    indexer = self.columns._get_indexer_strict(key, "columns")[1]
              ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^
  File "/Users/aditya/doctor-email-automation/backend/venv/lib/python3.14/site-packages/pandas/core/indexes/base.py", line 6212, in _get_indexer_strict
    self._raise_if_missing(keyarr, indexer, axis_name)
    ~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/aditya/doctor-email-automation/backend/venv/lib/python3.14/site-packages/pandas/core/indexes/base.py", line 6264, in _raise_if_missing
    raise KeyError(f"{not_found} not in index")
KeyError: "['Appointment Provider Name'] not in index"
2026-01-19 10:20:22,557 | INFO | File received: 01 08.xlsx
2026-01-19 10:20:22,557 | INFO | Started processing file: /Users/aditya/doctor-email-automation/backend/uploads/01 08.xlsx
2026-01-19 10:20:22,568 | INFO | Excel loaded successfully. Rows: 98
2026-01-19 10:20:22,568 | ERROR | ❌ Error occurred while processing excel
Traceback (most recent call last):
  File "/Users/aditya/doctor-email-automation/backend/app/processor.py", line 22, in process_excel
    df = df[
         ~~^
        ["Patient First Name", "Patient E-mail", "Appointment Provider Name"]
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ].copy()
    ^
  File "/Users/aditya/doctor-email-automation/backend/venv/lib/python3.14/site-packages/pandas/core/frame.py", line 4119, in __getitem__
    indexer = self.columns._get_indexer_strict(key, "columns")[1]
              ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^
  File "/Users/aditya/doctor-email-automation/backend/venv/lib/python3.14/site-packages/pandas/core/indexes/base.py", line 6212, in _get_indexer_strict
    self._raise_if_missing(keyarr, indexer, axis_name)
    ~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/aditya/doctor-email-automation/backend/venv/lib/python3.14/site-packages/pandas/core/indexes/base.py", line 6264, in _raise_if_missing
    raise KeyError(f"{not_found} not in index")
KeyError: "['Appointment Provider Name'] not in index"
2026-01-19 10:20:22,568 | ERROR | Upload failed
Traceback (most recent call last):
  File "/Users/aditya/doctor-email-automation/backend/app/main.py", line 50, in upload_excel
    zip_path = process_excel(str(file_path), str(OUTPUT_DIR))
  File "/Users/aditya/doctor-email-automation/backend/app/processor.py", line 85, in process_excel
    raise e
  File "/Users/aditya/doctor-email-automation/backend/app/processor.py", line 22, in process_excel
    df = df[
         ~~^
        ["Patient First Name", "Patient E-mail", "Appointment Provider Name"]
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ].copy()
    ^
  File "/Users/aditya/doctor-email-automation/backend/venv/lib/python3.14/site-packages/pandas/core/frame.py", line 4119, in __getitem__
    indexer = self.columns._get_indexer_strict(key, "columns")[1]
              ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^
  File "/Users/aditya/doctor-email-automation/backend/venv/lib/python3.14/site-packages/pandas/core/indexes/base.py", line 6212, in _get_indexer_strict
    self._raise_if_missing(keyarr, indexer, axis_name)
    ~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/aditya/doctor-email-automation/backend/venv/lib/python3.14/site-packages/pandas/core/indexes/base.py", line 6264, in _raise_if_missing
    raise KeyError(f"{not_found} not in index")
KeyError: "['Appointment Provider Name'] not in index"
2026-01-19 10:43:32,124 | INFO | File received: 01 09.xlsx
2026-01-19 10:43:32,125 | INFO | Started processing file: /Users/aditya/doctor-email-automation/backend/uploads/01 09.xlsx
2026-01-19 10:43:32,152 | INFO | Excel loaded successfully. Rows: 71
2026-01-19 10:43:32,156 | INFO | Dropped 8 invalid rows
2026-01-19 10:43:32,159 | INFO | Created file for doctor 'Bice, Jamie' with 26 records
2026-01-19 10:43:32,160 | INFO | Created file for doctor 'KAR, JITESH K' with 6 records
2026-01-19 10:43:32,161 | INFO | Created file for doctor 'Nguyen, Jeffrey' with 31 records
2026-01-19 10:43:32,161 | INFO | Created combined all_doctors.csv
2026-01-19 10:43:32,162 | INFO | ZIP file created successfully
2026-01-19 10:43:32,162 | INFO | Processing completed successfully
